<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Email Verified - CITYNOISE</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;700&display=swap"
      rel="stylesheet"
    />
    <style>
      /* [Your existing styles remain unchanged] */
    </style>
  </head>
  <body>
    <div class="card">
      <!-- Brand logo -->
      <div class="logo">CITY<span class="logo-bold">NOISE</span></div>

      <!-- Success icon -->
      <div class="success-icon">âœ“</div>

      <!-- Main message -->
      <h1 class="title">Email Verified!</h1>
      <p class="message">
        Your email address has been successfully verified. You can now close
        this window and return to the citynoise app and continue.
      </p>
      <!-- Footer -->
      <p class="footer-text">This window will close automatically</p>
    </div>

    <script type="module">
      import {
        Client,
        Account,
      } from "https://cdn.jsdelivr.net/npm/appwrite@13.0.0/+esm";

      const client = new Client()
        .setEndpoint("https://cloud.appwrite.io/v1")
        .setProject("<PROJECT_ID>"); // Replace with your actual Project ID

      const account = new Account(client);

      const urlParams = new URLSearchParams(window.location.search);
      const secret = urlParams.get("secret");
      const userId = urlParams.get("userId");

      if (userId && secret) {
        account
          .updateVerification({ userId, secret })
          .then((response) => {
            console.log("Verification successful:", response);
          })
          .catch((error) => {
            console.error("Verification failed:", error);
          });
      } else {
        console.warn("Missing userId or secret in URL");
      }

      // Auto-close after 10 seconds as a fallback
      setTimeout(() => {
        window.close();
      }, 10000);
    </script>
  </body>
</html>
